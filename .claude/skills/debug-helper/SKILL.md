---
name: debug-helper
description: デバッグを支援する。「バグ調査」「エラー原因を調べて」「なぜ動かないか」などの依頼時に使用。
---

# 目的

問題の根本原因を特定し、解決策を提案する。

# 手順

1. **症状の確認**
   - エラーメッセージ、スタックトレース
   - 再現条件（いつ、どの操作で発生するか）
   - 期待される動作 vs 実際の動作

2. **仮説の立案**
   - エラーメッセージから推測
   - 変更履歴から推測
   - 類似の既知問題から推測

3. **調査**
   - 関連コードの読解
   - ログの確認
   - 入力データの検証

4. **原因の特定**
   - 仮説を検証
   - 根本原因を特定

5. **解決策の提案**
   - 修正案を提示
   - 再発防止策を検討

# よくある原因カテゴリ

| カテゴリ | 例 |
| -------- | -- |
| 型の不一致 | null/undefined、文字列/数値の混同 |
| 非同期処理 | await 漏れ、レースコンディション |
| スコープ | 変数の参照先ミス、クロージャの誤解 |
| 状態管理 | 古い状態の参照、不正な状態遷移 |
| 外部依存 | API 仕様変更、ネットワークエラー |
| 環境差異 | ローカル vs 本番、OS 差異 |

# デバッグチェックリスト

```markdown
## 基本確認
- [ ] エラーメッセージを正確に読んだか
- [ ] スタックトレースの発生箇所を確認したか
- [ ] 最近の変更を確認したか

## データ確認
- [ ] 入力データは期待通りか
- [ ] null/undefined が混入していないか
- [ ] データ型は正しいか

## 環境確認
- [ ] 環境変数は正しいか
- [ ] 依存ライブラリのバージョンは正しいか
- [ ] キャッシュが古くないか

## 再現確認
- [ ] 最小限の再現コードを作成できるか
- [ ] 特定の条件でのみ発生するか
```

# 出力フォーマット

```markdown
## デバッグレポート

### 症状
[問題の説明]

### 原因
[特定した根本原因]

### 該当箇所
`ファイル名:行番号`
[問題のコード]

### 修正案
[修正コード]

### 再発防止
[テスト追加、型定義強化など]
```

# 制約

- 推測ではなく事実に基づく
- 複数の可能性がある場合は列挙
- 修正は最小限の変更で
