---
name: architecture-guard
description: アーキテクチャ品質を検証するガードレールを作成・実行する。「アーキテクチャ検証」「設計規約チェック」「ガードレール追加」などの依頼時に使用。
---

# 目的

コードベースのアーキテクチャ品質を自動検証するガードレールを作成・運用する。

# コンセプト

**コードベースが AI を教育する**

- ガードレールで RED → AI が仕様を確認して修正
- セッションが切れても、ガードレールが設計規約を伝える
- 人手なしにアーキテクチャ品質を維持

# ガードレールの種類

| 種類 | 対象 | 検証方法 |
| ---- | ---- | -------- |
| 横のガードレール | どう作るか（実装品質） | 静的解析 |
| 縦のガードレール | 何を提供するか（機能） | テスト実行 |

# 手順

1. **問題の特定**
   - 繰り返し発生する設計違反を特定
   - `references/guard-examples.md` を参照

2. **ガードレール設計**
   - @what / @why / @failure パターンで記述
   - 検証ロジックを実装

3. **統合**
   - CI/CD に組み込み
   - 違反時は非ゼロ終了

# @what / @why / @failure パターン

```typescript
/**
 * @what リポジトリの戻り値が Result<T, E> 形式であること
 * @why エラーハンドリングの一貫性を保証するため
 * @failure 生の Promise を返すと例外処理が不統一になる
 */
```

# 参照

- `references/guard-examples.md` - ガードレール実装例
- `scripts/run-guard.ts` - 統一実行ラッパー

# 制約

- ESLint で対応できるものは ESLint を使用
- カスタムガードレールは複数ファイル横断・型情報が必要な場合に
- 問題が出るたびに漸進的に追加
